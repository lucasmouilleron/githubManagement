githubManagement
================

TODO
----
- respond on github webkhook
- import builder simplifiÃ©
- locals files are in a folder on the test server
- api create tag

Install requirements
--------------------
- `curl -sS https://getcomposer.org/installer | php`
- `mv composer.phar /usr/local/bin/composer`

Install
-------
- `cd api && composer install`
- `mv api/config.php.sample api/config.php`

Architecture
------------
- `builder` : default project builder
- `hooks/default.php` : default web hook handler
- `hooks/projects` : project specific web hook handlers (hooks must be named `owner__repo.php`)
- `locals` : projects locals files
- `repos-clones` : temporary repos clones (clones for building then copying to `web`)
- `api` : the public API
- `web` : web projects exports (ie the test web server root)

API Routes
----------
- Create a tag :
	- `POST /repos/:owner/:repo/tag` :
	- post params : tag-revision, tag-name, tag-message
	- get param : github-token (the github token of the user)
	- example : `Requests::post(getAPIURL()."/repos/lucasmouilleron/testDeploy/tag?github-token=THE_USER_TOKEN", array(), array("tag-revision"=>$revision,"tag-name"=>"tag".time(),"tag-message"=>"message !"))`;
- Init deployments : 
	- `POST /repos/:owner/:repo/hook/init`
	- post params : none
	- get param : github-token (the github token of the user) (use `GITHUB_MASTER_TOKEN` if called from PHP for administration purpose)
	- example : `Requests::post(getAPIURL()."/repos/lucasmouilleron/testDeploy/hook/init?github-token=".GITHUB_MASTER_TOKEN);`
- Github hook : 
	- `POST /repos/:owner/:repo/hook/:token`
	- called by github on tag create
	- `token` is generated by us and is used for security purpose